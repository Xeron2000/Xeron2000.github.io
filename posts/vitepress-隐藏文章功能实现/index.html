<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Su 素</title>
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22></svg>">
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --meta-color: #a0a0a0;
            --link-color: #d0d0d0;
            --accent-color: #f0f0f0;
            --font-main: "Georgia", "Times New Roman", "Songti SC", "SimSun", serif;
            --font-mono: "Menlo", "Monaco", "Courier New", monospace;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-main);
            line-height: 1.8;
            max-width: 700px;
            margin: 0 auto;
            padding: 40px 20px;
            font-size: 16px;
        }

         
        header {
            margin-bottom: 60px;
            padding-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: baseline;
        }

        .site-title {
            font-size: 1.5em;
            font-weight: bold;
            text-decoration: none;
            color: var(--text-color);
            letter-spacing: 1px;
        }

        nav a {
            margin-left: 20px;
            text-decoration: none;
            color: var(--meta-color);
            font-size: 0.9em;
            cursor: pointer;
        }

        nav a:hover, nav a.active {
            color: var(--text-color);
            text-decoration: underline;
        }

         
        a {
            color: var(--link-color);
            text-decoration: underline;
            text-decoration-thickness: 1px;
            text-underline-offset: 3px;
            transition: all 0.2s;
        }
        a:hover {
            background-color: rgba(208, 208, 208, 0.1);
        }

         
        .archive-list {
            list-style: none;
            padding: 0;
        }

        .archive-item {
            display: flex;
            align-items: baseline;
            margin-bottom: 16px;
            padding-bottom: 8px;
        }

        .archive-date {
            font-family: var(--font-mono);
            color: var(--meta-color);
            font-size: 0.85em;
            width: 110px;
            flex-shrink: 0;
        }

        .archive-title {
            font-weight: normal;
            text-decoration: none;
            cursor: pointer;
        }

         
        .post-header {
            margin-bottom: 40px;
            text-align: center;
        }

        .post-title {
            font-size: 2em;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .post-meta {
            font-family: var(--font-mono);
            color: var(--meta-color);
            font-size: 0.9em;
        }

        .post-content {
            text-align: justify;
        }

        .post-content p {
            margin-bottom: 1.5em;
        }

        .post-content h2 {
            font-size: 1.4em;
            margin-top: 2em;
            margin-bottom: 1em;
        }

        .post-content blockquote {
            margin: 1.5em 0;
            padding: 1em 1.5em;
            background-color: rgba(255, 255, 255, 0.05);
            font-style: italic;
            color: var(--meta-color);
        }

        .post-content blockquote p {
            margin-bottom: 0;
        }

         
        .about-section {
            margin-bottom: 50px;
        }

        .friends-list {
            list-style: none;
            padding: 0;
            margin-top: 20px;
        }

        .friend-item {
            margin-bottom: 15px;
        }

        .friend-item a {
            font-weight: bold;
            margin-right: 10px;
        }

        .friend-desc {
            color: var(--meta-color);
            font-size: 0.9em;
        }

         
        footer {
            margin-top: 80px;
            padding-top: 20px;
            text-align: center;
            font-size: 0.8em;
            color: var(--meta-color);
            font-family: var(--font-mono);
        }

         
        .post-content pre,
        .post-content .highlight {
            position: relative;
            background-color: #2d2d2d;
            border-radius: 6px;
            padding: 16px;
            margin: 1.5em 0;
            overflow-x: auto;
            font-family: var(--font-mono);
            font-size: 0.9em;
            line-height: 1.5;
        }

        .post-content pre code,
        .post-content .highlight pre {
            display: block;
            white-space: pre-wrap;
            word-wrap: break-word;
            word-break: break-all;
            color: var(--text-color);
            background: none;
            padding: 0;
            margin: 0;
        }

         
        .post-content .highlight pre {
            background: none !important;
            color: var(--text-color) !important;
        }

        .post-content .highlight pre code span {
            display: inline;
        }

  
         
        .post-content :not(pre) > code {
            background-color: #404040;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: var(--font-mono);
            font-size: 0.9em;
            color: var(--text-color);
        }
    </style>
</head>
<body>
    <header>
    <a href="https://blog.040304.xyz/" class="site-title">Su 素</a>
    <nav>
        <a href="https://blog.040304.xyz/">首页</a>
        <a href="https://blog.040304.xyz/about/">关于 & 友链</a>
    </nav>
</header>

    <main id="app">
        
<article>
    <div class="post-header">
        <h1 class="post-title">VitePress 隐藏文章功能实现</h1>
        <div class="post-meta">发布于 2025-08-24</div>
    </div>
    <div class="post-content">
        <h2 id="隐藏文章功能的实现">隐藏文章功能的实现</h2>
<p>在 md 文件的 frontmatter 中设置 <code>hidden: true</code>，从而在构建时将文章从所有列表中排除</p>
<h3 id="实现方式构建时过滤">实现方式：构建时过滤</h3>
<p>这个逻辑在构建阶段执行，核心代码位于 <a href=".vitepress/theme/serverUtils.ts"><code>./.vitepress/theme/serverUtils.ts</code></a></p>
<ol>
<li>
<p><strong>在 <code>config.ts</code> 中调用</strong>：
在 <a href=".vitepress/config.ts"><code>./.vitepress/config.ts</code></a> 中，<code>getPosts</code> 函数被调用，用于获取所有文章数据</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// .vitepress/config.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">defineConfig</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;vitepress&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">getPosts</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;./theme/serverUtils&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">pageSize</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">defineConfig</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">themeConfig</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">posts</span>: <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">getPosts</span>(<span style="color:#a6e22e">pageSize</span>) <span style="color:#75715e">// 获取处理后的文章列表
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div></li>
<li>
<p><strong>在 <code>serverUtils.ts</code> 中过滤</strong>：
<a href=".vitepress/theme/serverUtils.ts:6"><code>getPosts</code></a> 函数负责读取所有文章并进行处理</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// .vitepress/theme/serverUtils.ts (部分代码)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getPosts</span>(<span style="color:#a6e22e">pageSize</span>: <span style="color:#66d9ef">number</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">paths</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">globby</span>([<span style="color:#e6db74">&#39;posts/**.md&#39;</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">posts</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">Promise</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">all</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// ... 读取每篇文章的 frontmatter ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        ()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">showHidden</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">SHOW_HIDDEN</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;true&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">showHidden</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 根据 frontmatter 中的 &#39;hidden&#39; 字段过滤
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">posts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">posts</span>.<span style="color:#a6e22e">filter</span>((<span style="color:#a6e22e">post</span>) <span style="color:#f92672">=&gt;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">post</span>.<span style="color:#a6e22e">frontMatter</span>.<span style="color:#a6e22e">hidden</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">posts</span>.<span style="color:#a6e22e">sort</span>(<span style="color:#a6e22e">_compareDate</span> <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">any</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">posts</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ol>
<ul>
<li><code>posts.filter((post) =&gt; !post.frontMatter.hidden)</code>：遍历所有文章，只保留那些 <code>frontMatter.hidden</code> 不为 <code>true</code> 的文章</li>
<li><strong>环境变量 <code>SHOW_HIDDEN</code></strong>：如果在构建时设置环境变量 <code>SHOW_HIDDEN=true</code>，则所有文章（包括被隐藏的）都会被显示出来</li>
</ul>

    </div>
    <div style="margin-top:50px; text-align:center;">
        <a href="https://blog.040304.xyz/" style="cursor:pointer; font-family:var(--font-mono)">← 返回列表</a>
    </div>
</article>

    </main>

    <footer>
    &copy; 2025 Su 素. Text Only.
</footer>

    </body>
</html>